<?xml version="1.0"?>
<!--
Copyright 2004 The Apache Software Foundation

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<document>
  <properties>
    <title>Getting Started with Jetspeed 2</title>
    <subtitle>Getting up and running quickly</subtitle>
    <authors>
      <person name="David Sean Taylor" email="taylor@apache.org"/>
      <person name="Ate Douma" email="ate@apache.org"/>
    </authors>
  </properties>
  <body>
<section name="Requirements">
<p>
It is expected that the user is familiar with both the <a href="http://maven.apache.org">Apache Maven</a>
 project tool and the <a href="http://ant.apache.org">Apache Ant</a> build tool.
</p>
<ul>
  <li><a href="http://ant.apache.org/bindownload.cgi">Ant 1.5</a> or higher</li>
  <li><a href="http://maven.apache.org/start/download.html">Maven 1.0</a> or higher</li>
  <li>Java 1.4 or higher</li>
  <li>Servlet 2.3:<br/>
    Tomcat 4.1.x<br/>
    <b>or</b> <br/>
    Tomcat 5.x</li>
</ul>
</section>
<section name='1. Get Maven Ready'>
<p>If you have not already done so, download and install Maven.</p>
</section>
<section name='2. Build Properties'>
<p>Please set these values in your ${USER_HOME}/<code>build.properties</code> file:</p>
<table>
  <tr> 
    <th>property</th>
    <th>example</th>
    <th>what is it?</th>
  </tr>
  <tr> 
    <td>org.apache.jetspeed.project.home</td>
    <td>${JETSPEED2_HOME}/</td>
    <td>The root of your jetspeed2 installation, for example /home/apache/jakarta-jetspeed-2</td>
  </tr>
  <tr> 
    <td>org.apache.jetspeed.server.home</td>
    <td>${CATALINA_HOME}/</td>
    <td>The root of your Tomcat server installation.</td>
  </tr>
  <tr> 
    <td>org.apache.jetspeed.catalina.version.major</td>
    <td>4</td>
    <td>Are you using Tomcat 4.1.x or 5.x?</td>
  </tr>
  <tr> 
    <td>org.apache.jetspeed.server.shared</td>
    <td>${org.apache.jetspeed.server.home}/shared/lib/</td>
    <td>The location of the shared jars in your Tomcat installation.</td>
  </tr>
  <tr> 
    <td>org.apache.jetspeed.deploy.war.dir</td>
    <td>${org.apache.jetspeed.server.home}/webapps/</td>
    <td>The location to deploy web application in Tomcat.</td>
  </tr>
  <tr>
    <td>org.apache.jetspeed.services.autodeployment.user</td>
    <td>your-tomcat-manager-user</td>
    <td>a Tomcat user with the manager role.
        See the Tomcat Configuration section below.
    </td>
  </tr>
  <tr>
    <td>org.apache.jetspeed.services.autodeployment.password</td>
    <td>your-tomcat-manager-user-password</td>
    <td>The password of the Tomcat manager user.</td>
  </tr>
</table>
<p>
<i>If you are using Tomcat 5.x, the allBuild goal described below will install a 
patched version of the JAASRealm class in ${org.apache.jetspeed.server.home}/server/classes to
enable Jetspeed JAAS based security.
For more information about this patch see: 
<a href='http://issues.apache.org/jira/browse/JS2-55'>
Issue 55: JAAS Authentication on Tomcat 5</a></i>.
</p>
<p>
To develop or deploy Jetspeed with another database (not the default HSQL), see the property configuration in the 
<a href='database.html'>Database Configuration documentation</a>.
</p>
</section>
<section name="3. Tomcat Configuration">
<p>
Jetspeed 2 now uses the Tomcat manager application for hotdeployment of portlet application war files.
To be able to do so it needs a configured Tomcat user with the predefined 'manager' role in
the ${CATALINA_HOME}/conf/tomcat-users.xml.
</p>
<p>
A minimal example tomcat-users.xml could look like:
  <pre>
    &lt;?xml version='1.0' encoding='utf-8'?&gt;
    &lt;tomcat-users&gt;
      &lt;role rolename="manager"/&gt;
      &lt;user username="j2deployer" password="j2deployer" roles="manager"/&gt;
    &lt;/tomcat-users&gt;
  </pre>
Make sure to use a more appropriate username and password. <br/>
With the above example the required autodeployment properties should be set as:
  <pre>
    org.apache.jetspeed.services.autodeployment.user=j2deployer
    org.apache.jetspeed.services.autodeployment.password=j2deployer
  </pre>
</p>
</section>
<section name='4. Building Jetspeed 2'>
<p>
If you are using the default Hypersonic database, this procedure requires two terminal sessions. 
If you are using another database, skip the immediate section below on Terminal Session #1.
</p>
<source test=""><![CDATA[
# Terminal Session #1: Start the Hypersonic database
cd ${jetspeed-2-home}
maven start.test.server
]]></source>
<p>
Terminal session #2, build the portal and all components and unit test Jetspeed-2:
</p>
<source test=""><![CDATA[
# Terminal Session #2: Build and Unit Test
cd ${jetspeed-2-home}
maven allClean allBuild
]]></source>
</section>
<section name="5. Deploying Jetspeed into Tomcat">
<p>
We only cover deploying to Tomcat 4 and Tomcat 5.
Step #1 below is optional if you are NOT using the default Hypersonic database.
</p>
<ul>
<li>1. If you are using the Hypersonic SQL database, make sure you have terminated the test HSQLserver.
       Then in the same terminal, start the production Hypersonic database by typing 
       <br/><br/><b>maven start.production.server</b><br/><br/>
</li>
<li>2. (in seperate window/terminal session) <br/><br/><b>cd ${jetspeed-2-home}</b><br/><br/>
</li>
<li>3. <b>maven quickStart</b><br/><br/> This will recreate the DB to deploy into.  
       WARNING This will drop all the tables and data in the production database.<br/><br/>
</li>
<li>4. Start up Tomcat. With a browser, go to: <br/><br/><b>http://localhost:8080/jetspeed</b><br/>
</li>
</ul>
</section>

</body>
</document>

