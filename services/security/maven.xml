<project default="java:jar"
         xmlns:j="jelly:core"
         xmlns:define="jelly:define"
         xmlns:reactor="reactor">

  <!-- Target of maven test:single test -->
  <!--<property name='testcase' value='org.apache.jetspeed.security.TestPermissionManagerService'/>-->
  <!--<property name='testcase' value='org.apache.jetspeed.security.TestUserManagerService'/>-->
  <property name='testcase' value='org.apache.jetspeed.security.TestRoleManagerService'/>
  <!--<property name='testcase' value='org.apache.jetspeed.security.TestGroupManagerService'/>-->
  <!--<property name='testcase' value='org.apache.jetspeed.security.TestLoginModule'/>-->
  <!--<property name='testcase' value='org.apache.jetspeed.security.TestRdbmsPolicy'/>-->

  <!-- ================================================================ -->
  <!-- Set System properties for junit                                  -->
  <!-- ================================================================ -->
  <preGoal name="test:single">
     <j:set var="java.security.auth.login.config" value="src/webapp/WEB-INF/conf/jaas/login.conf"/>
     <j:set var="applicationRoot" value="./../../portal/src/webapp"/>
     <j:set var="maven.junit.sysproperties">java.security.auth.login.config applicationRoot</j:set>
  </preGoal>
 
  <preGoal name="test:test">
    <j:set var="java.security.auth.login.config" value="src/webapp/WEB-INF/conf/jaas/login.conf"/>
    <j:set var="applicationRoot" value="./../../portal/src/webapp"/>
    <j:set var="maven.junit.sysproperties">java.security.auth.login.config applicationRoot</j:set>
  </preGoal>

  <!-- ================================================================ -->
  <!-- Merge OJB desriptor with Jetspeed main OJB descriptor            -->
  <!-- ================================================================ -->
  <goal name="ojb.registry">
    <copy  file="./src/webapp/WEB-INF/conf/ojb/repository_security.xml" tofile="./../../portal/src/java/repository_security.xml"/>
<!--    <copy  file="./src/webapp/WEB-INF/conf/ojb/repository_security.xml" tofile="./../../portal/src/test/repository_security.xml"/> -->
  </goal>

  
</project>
