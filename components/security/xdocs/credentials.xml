<document>
    <properties>
        <title>Jetspeed 2 Security - Credentials Management</title>
        <authors>
            <person name="David Le Strat" email="dlestrat@apache.org" />
        </authors>
    </properties>
    <body>
        <section name="Credentials Management Overview">
            <p>
                Jetspeed
                <code>DefaultCredentialHandler</code>
                provides the following features:
            </p>
            <ol>
                <li>
                    Provides the ability to store password in a encoded fashion. The initial implementation uses
                    <code>SHA-1</code> and <code>Base64</code> as a default encoding.  The default 
                    <code>MessageDisgetCredentialPasswordEncoder</code> implements <code>CredentialPasswordEncoder</code>
                    and uses <a href="http://java.sun.com/j2se/1.4.2/docs/api/java/security/MessageDigest.html">MessageDigest</a>
                    hash algorithms for password encryption.
                </li>
                <li>Provides the ability to specify a minimum length and a minimum number of numeric characters in a password</li>
                <li>
                    Keeps an history (queue) of previously used password and preventing a user to reuse a password that is currently stored in the user's
                    password history (queue). The queue size is configurale.
                </li>
                <li>Automatically expires a user's password after a configurable time.</li>
                <li>Warns users that their password is about to expire. Notification time period is configurable.</li>
                <li>Locks a user account when the current password is expired.</li>
                <li>Forces a user to change his/her password on first use.</li>
                <li>Disable a user's password after a certain number of unsuccessful authentication attempts.</li>
            </ol>
        </section>
        <section name="DefaultCredentialHandler Implementation">
            <p>
                The class diagram below describes the components used for the
                <code>DefaultCredentialHandler</code>
                implementation.
            </p>
            <p align="center">
                <img src="images/credential-handler-c.gif" border="0" />
            </p>
            <table>
                <tr>
                    <th>Bean</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><code>DefaultCredentialHandler</code></td>
                    <td>Encapsulates the operations involving manipulation of credentials.</td>
                </tr>
                <tr>
                    <td>PasswordCredentialProvider</td>
                    <td>Provides the encoding and validation rules for passwords through the <code>CredentialPasswordEncoder</code>
                    which encapsulates the encoding and <code>CredentialPasswordValidator</code> which encapsulates
                    the password validation rules.</td>
                </tr>
                <tr>
                    <td>InternalPasswordCredentialInterceptor</td>
                    <td>Provide credential lifecycle management.  Manages parameters such as maximum number of authentication failures,
                    maximum life span of a credential in days and how much history to retain for a given credential.</td>
                </tr>
            </table>
            <p>
                The OJB mappings for the default credentials implementation are described in 
                <code>security_repository.xml</code>:
                <ul>
                    <li><code>InternalCredential</code>: Maps to the SECURITY_CREDENTIAL table.</li>
                </ul>
                The following database schema is used to stored credentials and their associations to principals.
            </p>
            <p align="center">
                <img src="images/principals-credentials-schema.gif" border="0" />
            </p>
        </section>
    </body>
</document>