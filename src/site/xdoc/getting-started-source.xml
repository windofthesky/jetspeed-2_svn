<?xml version="1.0"?>
<!--
	Licensed to the Apache Software Foundation (ASF) under one or more
	contributor license agreements.  See the NOTICE file distributed with
	this work for additional information regarding copyright ownership.
	The ASF licenses this file to You under the Apache License, Version 2.0
	(the "License"); you may not use this file except in compliance with
	the License.  You may obtain a copy of the License at
	
	http://www.apache.org/licenses/LICENSE-2.0
	
	Unless required by applicable law or agreed to in writing, software
	distributed under the License is distributed on an "AS IS" BASIS,
	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	See the License for the specific language governing permissions and
	limitations under the License.
-->
<document>
	<properties>
		<title>
			Getting Started with Jetspeed 2 using a Source Release (deprecated)
		</title>
		<subtitle>Getting ready to modify Jetspeed</subtitle>
		<authors>
			<person name="David Sean Taylor" email="taylor@apache.org" />
			<person name="Ate Douma" email="ate@apache.org" />
			<person name="David Le Strat" email="dlestrat@apache.org" />
			<person name="Ron Wheeler"
				email="rwheeler@artifact-software.com" />
		</authors>
	</properties>
	<body>
		<section name="1. Naming Conventions and Basic Assumptions (deprecated)">
			<subsection name="Source Basic Assumptions">
				<ul>
					<li>
						Unless otherwise specified, you should be
						running all maven build commands from within the
						Jetspeed directory (if you are just building
						Jetspeed) or from within your custom portal
						directory.
					</li>
					<li>
						You must use "/" as a file seperator on both
						*nix and windows, e.g. c:/windows, and /home.
					</li>
				</ul>
			</subsection>
			<subsection name="Naming Conventions">
				<p>
					Below is a listing of common conventions used within
					this document.
				</p>
				<p>
					Variables are represented as ${
					<i>some_variable</i>
					}. This may signify a setting in Jetspeed or may
					represent a setting within your environment.
					Properties files are also capable of specifying
					variables within them.
				</p>
				<p>
					For example, ${org.apache.jetspeed.server.home}
					references either a property defined further up in
					the properties file, a variable that has been
					defined somehwere within the build process or
					defined in another build file within Jetspeed.
				</p>
				<ul>
					<li>
						<b>${USER_HOME}</b>
						: This is the user's home directory. For Windows
						systems, this generally c:\Documents and
						Settings\${userName} where ${userName} is the
						name you use to log into windows.
						<br />
						${USER.HOME} is synonymous with ${USER_HOME}
						within this document.
					</li>
					<li>
						<b>${CATALINA_HOME}</b>
						: This is the location of your tomcat
						installation, e.g.
						<i>c:/tomcat</i>
						.
					</li>
				</ul>
			</subsection>
			<subsection name="Source Subversion (SVN)">
				<p>
					<a href="http://subversion.tigris.org">
						Subversion (SVN)
					</a>
					is used in the Jetspeed project to manage the source
					files. SVN is very similar to CVS. For those user's
					on Windows system who prefer non-command line access
					we suggest using
					<a href="http://tortoisesvn.tigris.org">
						TortoiseSVN
					</a>
					which plugs into your Windows Explorer view. For
					those using the Eclipse IDE, the
					<a href="http://subclipse.tigris.org">Subclipse</a>
					plugin is available for SVN access.
				</p>
			</subsection>
			<subsection name="Maven Setup">
				<p>
					We will not go into the specifics of Maven as that
					is beyond the scope of this document. However, here
					are a few bits of standard maven jargon we feel is
					important for you to know.
				</p>
				<p>
					You will see mention of a
					<i>maven repository</i>
					in this document. When you install Maven the .maven/
					directory is created in your ${USER_HOME) directory.
					<br />
					Under .maven/ you will see a
					<i>repository</i>
					directory. This is were Maven stores all the jars
					that it downloads when you run your builds. This is
					also were Maven puts your jars and wars that you
					build. They will be stored in a directory structure
					that has the format of
					${groupId}/${projectId}/jars/${projectId}-{$version}.jar
					for jar files and
					${groupId}/${projectId}/wars/${projectId}.war for
					war files. The ${groupId}, ${projectId} and
					${version} variables are discussed later on in this
					document. Jar and war files will also be created in
					your project in the
					<i>/target</i>
					directory.
				</p>
			</subsection>
		</section>


		<section name="2. Creating a new Portal Application">
			<p>
				Now we're going to configure, setup and build a new
				custom portal application using the Jetspeed-2
				maven-plugin.
			</p>
			<subsection
				name="4.1 Install the Jetspeed 2 maven-plugin">
				<p>
					Maven2 install the plugins by it self, make sure you mention your repositories in your settings.xml				
				</p>
			</subsection>
			<subsection name="4.2 Generate a new portal project">
				<p>
					Once you have the maven-plugin installed and set
					properties as needed, generate a default portal
					configuration using the plugin as follows:
					<source>
						<![CDATA[
mvn archetype:generate -DarchetypeGroupId=org.apache.portals.jetspeed-2 -DarchetypeArtifactId=jetspeed-archetype -DarchetypeVersion=2.2-SNAPSHOT -DgroupId=org.apache.portals.tutorials -DartifactId=express-demo -Dversion=1.0]]>
					</source>
					<i>
						This maven goal actually executes several
						subgoals which are further described in the
						<a href="j2-maven-plugin.html">
							maven-plugin documentation
						</a>
						itself.
					</i>
				</p>
			</subsection>
			<subsection
				name="4.3 Further customization of the portal">
				<p>
					You would need specify you database which would be used to creating portal schema.
					jetspeed pluin have created an jetspeed-mvn-settings.xml, in root of project location
					you need to fill properties, with correct database information.
					
					You also need to specify the tomcat location, where portal need to deployed make sure 
					tomcat version should be above <b>5.5.27</b>
				</p>
				<source>
					<![CDATA[
<org.apache.jetspeed.test.jdbc.driver.groupId>org.apache.derby</org.apache.jetspeed.test.jdbc.driver.groupId>
        
        <org.apache.jetspeed.test.jdbc.driver.artifactId>derby</org.apache.jetspeed.test.jdbc.driver.artifactId>
        
        <org.apache.jetspeed.test.jdbc.driver.version>10.3.2.1</org.apache.jetspeed.test.jdbc.driver.version>
        
        <!-- make sure to check/correct the database.url path location (e.g. /tmp on Linux usually is restricted) -->
        
        <org.apache.jetspeed.test.database.default.name>derby</org.apache.jetspeed.test.database.default.name>
        
        <org.apache.jetspeed.test.database.url>jdbc:derby:/tmp/derby/testdb;create=true</org.apache.jetspeed.test.database.url>
        
        <org.apache.jetspeed.test.database.driver>org.apache.derby.jdbc.EmbeddedDriver</org.apache.jetspeed.test.database.driver>
        
        <org.apache.jetspeed.test.database.user></org.apache.jetspeed.test.database.user>
        
        <org.apache.jetspeed.test.database.password></org.apache.jetspeed.test.database.password>]]>
				</source>
			</subsection>
			<subsection name="4.5 Build the portal">
				<p>
					Once your portal configuration and setup is ready,
					you can build and install the portal application in
					your local maven repository (as needed for
					deployment) using the following standard maven goal.
					<source>
						<![CDATA[
mvn install]]>
					</source>
				</p>
				<p>
					You are now ready to deploy the new portal
					application. For this, skip the following section on
					building the Jetspeed 2 portal from source and
					continue with the
					<a href="#6__Deploy_and_Run">deployment</a>
					section.
				</p>
			</subsection>
		</section>
		<section name='5. Build Jetspeed 2 from source'>
			<p>
				Build the Jetspeed 2 portal directly from the source is
				somewhat easier to do but should only be done if you
				don't want to create a new, customizable portal.
			</p>
			<subsection
				name="5.1 Setup the Jetspeed 2 source and build properties">
				<p>
					The Jetspeed 2 source contains a
					<code>jetspeed-mvn-settings-sample.xml</code>
					file which provides all of the required portal
					configuration settings as described. You need copy this file to <code>jetspeed-mvn-settings.xml</code>			
					<a
						href="#Required_Portal_Configuration_Properties">
						above
					</a>
					.
				</p>
				<p>
					You should
					<i>
						<b>not</b>
					</i>
					define any of those properties in your
					<code>${m2_HOME}/settings.xml</code>
					.
					<br />
				</p>
				<p>
					When you are going to deploy the portal as described
					further below, you'll see references to the
					<code>org.apache.jetspeed.portal.home</code>
					which you can translate with the root folder of your
					Jetspeed 2 source.
				</p>
				<p>
					If you want to run the testcases when building the
					Jetspeed 2 sources
					<i>and</i>
					don't want to use the default Derby test database,
					you need to override the default test database
					properties, similar to the production database
					properties as described
					<a href="#Optional_Database_Server_Properties">
						above
					</a>
					:
					<ul>
						<li>
							<code>
								org.apache.jetspeed.test.database.default.name
							</code>
						</li>
						<li>
							<code>
								org.apache.jetspeed.test.database.url
							</code>
						</li>
						<li>
							<code>
								org.apache.jetspeed.test.database.user
							</code>
						</li>
						<li>
							<code>
								org.apache.jetspeed.test.database.password
							</code>
						</li>
						<li>
							<code>
								org.apache.jetspeed.test.database.driver
							</code>
						</li>
						<li>
							<code>
								org.apache.jetspeed.test.database.drivers.path
							</code>
						</li>
					</ul>
				</p>
			</subsection>
			<subsection
				name="Build the Jetspeed 2 portal and demo portlet applications">
				<p>
					For a full build and installation of the portal and
					the demo portlet applications in your local maven
					repository run:
					<source>
						<![CDATA[mvn clean install]]>
					</source>
				</p>
				<p>
					But, if you also want to run the testcases during
					the build run the following instead:
					<source>
						<![CDATA[mvn -Dmaven.test.skip=false clean install]]>
					</source>
				</p>
				<p>
					You are now ready to deploy the Jetspeed 2 Portal.
				</p>
			</subsection>
		</section>
		<section name="6. Deploy and Run">
			<subsection name="Deploy">
				<p>
					We currently only cover deploying to Tomcat 5 or
					Tomcat 5.5.
				</p>
				<p>
					Information about deployment to other application
					servers can be found at the The Jetspeed 2
					<a
						href="http://wiki.apache.org/portals/Jetspeed2">
						Wiki
					</a>
					.
				</p>
				<p>
					To deploy a default Jetspeed 2 portal, including the
					demo portlet applications, run the following in a
					<i>separate</i>
					console:
					<source>
						<![CDATA[
						mvn jetspeed:mvn -Dtarget=proddb
						]]>
					</source>
					<i>
						Note: the
						<a href="j2-maven-plugin.html">
							maven-plugin documentation
						</a>
						described other goals you can use to customize
						the deployment to your taste.
					</i>
				</p>
			</subsection>
			<subsection name="Run">
				<p>
					The final step is starting up your Tomcat server and
					the portal will automatically install any deployed
					portlet applications.
				</p>
				<p>
					Then you can access the portal with your browser at:
					<source><a href="http://localhost:8080/jetspeed">http://localhost:8080/jetspeed</a></source>
					or replace "jetspeed" in the above url with the name
					of you own portal application (
					<code>
						${org.apache.jetspeed.portal.artifactId}
					</code>
					).
				</p>
			</subsection>
			<subsection name="Default installed user accounts">
				<p>
					With the default Jetspeed 2 portal deployment,
					several example user accounts are inserted into the
					portal database with which you can logon to the
					portal:
					<table>
						<tr>
							<th>username</th>
							<th>password</th>
							<th>roles</th>
						</tr>
						<tr>
							<td>
								<code>admin</code>
							</td>
							<td>
								<code>admin</code>
							</td>
							<td>
								<code>admin, manager, user</code>
							</td>
						</tr>
						<tr>
							<td>
								<code>manager</code>
							</td>
							<td>
								<code>manager</code>
							</td>
							<td>
								<code>manager, user</code>
							</td>
						</tr>
						<tr>
							<td>
								<code>jetspeed</code>
							</td>
							<td>
								<code>jetspeed</code>
							</td>
							<td>
								<code>manager</code>
							</td>
						</tr>
						<tr>
							<td>
								<code>user</code>
							</td>
							<td>
								<code>user</code>
							</td>
							<td>
								<code>user</code>
							</td>
						</tr>
						<tr>
							<td>
								<code>tomcat</code>
							</td>
							<td>
								<code>tomcat</code>
							</td>
							<td></td>
						</tr>
					</table>
				</p>
			</subsection>
		</section>
	</body>
</document>
