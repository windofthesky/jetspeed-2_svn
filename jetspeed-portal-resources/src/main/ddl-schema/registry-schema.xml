<?xml version="1.0"?>
<!--
Licensed to the Apache Software Foundation (ASF) under one or more
contributor license agreements.  See the NOTICE file distributed with
this work for additional information regarding copyright ownership.
The ASF licenses this file to You under the Apache License, Version 2.0
(the "License"); you may not use this file except in compliance with
the License.  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<!DOCTYPE database SYSTEM "http://db.apache.org/torque/dtd/database_3_2.dtd">
<!-- Autogenerated by JDBCToXMLSchema! -->
<database name="j2">

    <!--
       Registry - this schema is not in normal form
       and thus relies on OJB to perform propagated
       delete and update operations: foreign keys and
       foreign key indexes are not declared here as
       a matter of consistency and because schema
       level cascade operations cannot ensure data
       consistency as is done elsewhere.
    -->

    <!--
       Create Portlet Definition Table
    -->
    <table name="PORTLET_DEFINITION">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="NAME" size="80" type="VARCHAR"/>
        <column name="CLASS_NAME" size="255" type="VARCHAR"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="EXPIRATION_CACHE" type="INTEGER"/>
        <column name="RESOURCE_BUNDLE" size="255" type="VARCHAR"/>
        <column name="PREFERENCE_VALIDATOR" size="255" type="VARCHAR"/>
        <column name="SECURITY_REF" size="40" type="VARCHAR"/>      
        <column name="CACHE_SCOPE" size="30" type="VARCHAR"/>
        <column name="CLONE_PARENT" required="false" size="80" type="VARCHAR"/>
    </table>

    <!--
       Create Portlet Application Table
    -->
    <table name="PORTLET_APPLICATION">
        <column name="APPLICATION_ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APP_NAME" required="true" size="80" type="VARCHAR"/>
        <column name="CONTEXT_PATH" required="true" size="255" type="VARCHAR"/>
        <column name="REVISION" required="true" type="INTEGER"/>
        <column name="VERSION" size="80" type="VARCHAR"/>
        <column name="APP_TYPE" type="INTEGER"/>
		<column name="CHECKSUM" size="80" type="VARCHAR"/>
        <column name="SECURITY_REF" size="40" type="VARCHAR"/>
        <column name="DEFAULT_NAMESPACE" size="120" type="VARCHAR"/>
        <column name="RESOURCE_BUNDLE" size="255" type="VARCHAR"/>
        <unique name="UK_APPLICATION">
            <unique-column name="APP_NAME"/>
        </unique>
    </table>                                                               

    <!--
       Create Portlet Application Metadata Fields Table
    -->    
    <table name="PA_METADATA_FIELDS">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OBJECT_ID" required="true" type="INTEGER"/>
        <column name="COLUMN_VALUE" required="true" type="LONGVARCHAR"/>
        <column name="NAME" required="true" size="100" type="VARCHAR"/>
        <column name="LOCALE_STRING" required="true" size="50" type="VARCHAR"/>
    </table>
    
    <!--
       Create Portlet Definition Metadata Fields Table
    -->    
    <table name="PD_METADATA_FIELDS">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OBJECT_ID" required="true" type="INTEGER"/>
        <column name="COLUMN_VALUE" required="true" type="LONGVARCHAR"/>
        <column name="NAME" required="true" size="100" type="VARCHAR"/>
        <column name="LOCALE_STRING" required="true" size="50" type="VARCHAR"/>
    </table>

    <!--
       Create Language Table
    -->
    <table name="LANGUAGE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="PORTLET_ID" required="true" type="INTEGER"/>
        <column name="LOCALE_STRING" required="true" size="50" type="VARCHAR"/>
        <column name="SUPPORTED_LOCALE" required="true" type="BOOLEANINT"/>
        <column name="TITLE" size="100" type="VARCHAR"/>
        <column name="SHORT_TITLE" size="100" type="VARCHAR"/>
        <column name="KEYWORDS" type="LONGVARCHAR"/>
    </table>
    
    <!--
       Create Supports Table
    -->
    <table name="PORTLET_SUPPORTS">
        <column name="SUPPORTS_ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="PORTLET_ID" required="true" type="INTEGER"/>
        <column name="MIME_TYPE" required="true" size="30" type="VARCHAR"/>
        <column name="MODES" type="VARCHAR" size="255"/>
        <column name="STATES" type="VARCHAR" size="255"/>
        <unique name="UK_SUPPORTS">
          <unique-column name="PORTLET_ID"/>
          <unique-column name="MIME_TYPE"/>
        </unique>
    </table>
    
    <!--
       Create Parameter Table
    -->
    <table name="PARAMETER">
        <column name="PARAMETER_ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="OWNER_CLASS_NAME" required="true" size="255" type="VARCHAR"/>
        <column name="NAME" required="true" size="80" type="VARCHAR"/>
        <column name="PARAMETER_VALUE" required="false" type="LONGVARCHAR"/>
    </table>

    <!--
       Portlet Entity - obsolete
       Represents the managed state of individual portlet instance within a "page"
       The instance within a "page" key is based on Window ID + principal
       Without the principal, the key represents the default preferences for the window
    <table name="PORTLET_ENTITY">
        <column name="PEID" primaryKey="true" required="true" type="INTEGER"/>
       <!- <column name="PORTLET_DEFINITION_ID" required="true" type="INTEGER"/> ->
        <column name="ID" required="true" size="80" type="VARCHAR"/>
        <column name="APP_NAME" required="true" size="80" type="VARCHAR"/>
        <column name="PORTLET_NAME" required="true" size="80" type="VARCHAR"/>
        <unique name="UK_ENTITY_ID">
            <unique-column name="ID"/>
        </unique>
    </table>
    -->
    
    <!--
       Security Role Reference
    -->
    <table name="SECURITY_ROLE_REFERENCE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="PORTLET_DEFINITION_ID" required="true" type="INTEGER"/>
        <column name="ROLE_NAME" required="true" size="150" type="VARCHAR"/>
        <column name="ROLE_LINK" size="150" type="VARCHAR"/>
    </table>
    
    <!--                                                                   
       Security Role                                                        
    -->                                                                     
    <table name="SECURITY_ROLE">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="NAME" required="true" size="150" type="VARCHAR"/>
    </table> 

    <!--
       User Attribute Reference
    -->
    <table name="USER_ATTRIBUTE_REF">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="NAME" size="150" type="VARCHAR"/>
        <column name="NAME_LINK" size="150" type="VARCHAR"/>
    </table>

	<!--
       User Attribute
    -->
    <table name="USER_ATTRIBUTE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="NAME" size="150" type="VARCHAR"/>
    </table>

	<!--
       Jetspeed Service
    -->
    <table name="JETSPEED_SERVICE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="NAME" size="150" type="VARCHAR"/>
    </table>

    
    <!-- 
       Localized Descriptions
    -->
    <table name="LOCALIZED_DESCRIPTION">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="OWNER_CLASS_NAME" required="true" size="255" type="VARCHAR"/>
        <column name="DESCRIPTION" required="true" type="LONGVARCHAR"/>
        <column name="LOCALE_STRING" required="true" size="50" type="VARCHAR"/>
    </table>
    
    <!--
       Localized Display Names
    -->
    <table name="LOCALIZED_DISPLAY_NAME">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="OWNER_CLASS_NAME" size="255" type="VARCHAR"/>
        <column name="DISPLAY_NAME" required="true" type="LONGVARCHAR"/>
        <column name="LOCALE_STRING" required="true" size="50" type="VARCHAR"/>
    </table>
    
    <!--
       CustomPortletMode
    -->
    <table name="CUSTOM_PORTLET_MODE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="CUSTOM_NAME" required="true" size="150" type="VARCHAR"/>
        <column name="MAPPED_NAME" size="150" type="VARCHAR"/>
        <column name="PORTAL_MANAGED" required="true" type="BOOLEANINT"/>        
    </table>
                         
    <!--
       CustomWindowState
    -->
    <table name="CUSTOM_WINDOW_STATE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="CUSTOM_NAME" required="true" size="150" type="VARCHAR"/>
        <column name="MAPPED_NAME" size="150" type="VARCHAR"/>
    </table>

    <table name="EVENT_DEFINITION">
    	<column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="LOCAL_PART" required="true" size="80" type="VARCHAR"/>
        <column name="NAMESPACE" required="false" size="80" type="VARCHAR"/>
        <column name="PREFIX" required="false" size="20" type="VARCHAR"/>        
        <column name="VALUE_TYPE" required="false" size="255" type="VARCHAR"/>
    </table>             

    <!-- 
	    EVENT ALIAS       
    -->
    <table name="EVENT_ALIAS">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="LOCAL_PART" required="true" size="80" type="VARCHAR"/>
        <column name="NAMESPACE" required="false" size="80" type="VARCHAR"/>
        <column name="PREFIX" required="false" size="20" type="VARCHAR"/>        
    </table>

    <!-- 
	    PUBLIC RENDER PARAM ALIAS       
    -->
    <table name="PARAMETER_ALIAS">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="LOCAL_PART" required="true" size="80" type="VARCHAR"/>
        <column name="NAMESPACE" required="false" size="80" type="VARCHAR"/>
        <column name="PREFIX" required="false" size="20" type="VARCHAR"/>        
    </table>

    <!-- 
	    PUBLISHING EVENT       
    -->
    <table name="PUBLISHING_EVENT">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="LOCAL_PART" required="true" size="80" type="VARCHAR"/>
        <column name="NAMESPACE" required="false" size="80" type="VARCHAR"/>
        <column name="PREFIX" required="false" size="20" type="VARCHAR"/>        
    </table>

    <!-- 
	    PROCESSING EVENT
    -->
    <table name="PROCESSING_EVENT">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="LOCAL_PART" required="true" size="80" type="VARCHAR"/>
        <column name="NAMESPACE" required="false" size="80" type="VARCHAR"/>
        <column name="PREFIX" required="false" size="20" type="VARCHAR"/>        
    </table>
    
   <!--                                                                   
	   SUPPORTED RENDER PARAMETERS                                                        
    -->                                                                     
    <table name="NAMED_PARAMETER">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="NAME" required="true" size="150" type="VARCHAR"/>
    </table> 
       
   <!--                                                                   
	   RUNTIME OPTIONS                                                        
    -->                                                                     
    <table name="RUNTIME_OPTION">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="OWNER_CLASS_NAME" required="true" size="255" type="VARCHAR"/>
        <column name="NAME" required="true" size="150" type="VARCHAR"/>
    </table> 
    
    <table name="RUNTIME_VALUE">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="RVALUE" required="true" size="200" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	   PUBLIC RENDER PARAMETERS                                                        
    -->                                                                     
    <table name="PUBLIC_PARAMETER">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="LOCAL_PART" required="true" size="80" type="VARCHAR"/>
        <column name="NAMESPACE" required="false" size="80" type="VARCHAR"/>
        <column name="PREFIX" required="false" size="20" type="VARCHAR"/>        
        <column name="IDENTIFIER" required="true" size="150" type="VARCHAR"/>
    </table> 

	<!--
		PORTLET FILTER 
	 -->      
    <table name="PORTLET_FILTER">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="FILTER_NAME" required="true" size="80" type="VARCHAR"/>
        <column name="FILTER_CLASS" required="false" size="255" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	   FILTER LIFECYCLE                                                        
    -->                                                                     
    <table name="FILTER_LIFECYCLE">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="NAME" required="true" size="150" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	   FILTER MAPPING
    -->                                                                     
    <table name="FILTER_MAPPING">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="FILTER_NAME" required="true" size="150" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	   FILTERED PORTLET                                                        
    -->                                                                     
    <table name="FILTERED_PORTLET">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="NAME" required="true" size="150" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	   PORTLET LISTENER
    -->                                                                     
    <table name="PORTLET_LISTENER">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="LISTENER_CLASS" required="false" size="255" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	   PORTLET SECURITY CONSTRAINT
    -->                                                                     
    <table name="PA_SECURITY_CONSTRAINT">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>  
        <column name="TRANSPORT" required="true" size="40" type="VARCHAR"/>
    </table> 

   <!--                                                                   
	    SECURED PORTLET NAME                                                       
    -->                                                                     
    <table name="SECURED_PORTLET">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="OWNER_ID" required="true" type="INTEGER"/>
        <column name="NAME" required="true" size="150" type="VARCHAR"/>
    </table> 
	              
   <!--                    
       LOCALE ENCODING MAPPING
    -->                                                                     
    <table name="LOCALE_ENCODING_MAPPING">                                            
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="APPLICATION_ID" required="true" type="INTEGER"/>
        <column name="LOCALE_STRING" required="true" size="50" type="VARCHAR"/>
        <column name="ENCODING" required="true" size="50" type="VARCHAR"/>
    </table> 
    
   <!-- 
      Preferences
    -->    

    <table name="PORTLET_PREFERENCE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="DTYPE" required="true" size="10" type="VARCHAR"/>
        <column name="APPLICATION_NAME" required="true" size="80" type="VARCHAR"/>
        <column name="PORTLET_NAME" required="true" size="80" type="VARCHAR"/>
        <column name="ENTITY_ID" type="VARCHAR" size="80"/>
        <column name="USER_NAME"  size="80" type="VARCHAR"/>
        <column name="NAME" required="true" size="254" type="VARCHAR"/>
        <column name="READONLY" required="true" type="BOOLEANINT"/>        
        <unique name="UIX_PORTLET_PREFERENCE">
          <unique-column name="DTYPE"/>
          <unique-column name="APPLICATION_NAME"/>
          <unique-column name="PORTLET_NAME"/>
          <unique-column name="ENTITY_ID"/>
          <unique-column name="USER_NAME"/>
          <unique-column name="NAME"/>
        </unique>
        <index name="IX_USER_PREFERENCE">
            <index-column name="DTYPE"/>
            <index-column name="USER_NAME"/>
        </index>
    </table>

    <table name="PORTLET_PREFERENCE_VALUE">
        <column name="ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="PREF_ID" primaryKey="true" required="true" type="INTEGER"/>
        <column name="IDX" primaryKey="true" required="true" type="SMALLINT"/>
        <column name="PREF_VALUE" size="4000" type="VARCHAR"/>
        <foreign-key foreignTable="PORTLET_PREFERENCE" name="FK_PORTLET_PREFERENCE" onDelete="cascade">
            <reference foreign="ID" local="PREF_ID"/>
        </foreign-key>             
        <index name="IX_PORTLET_PREFERENCE">
            <index-column name="PREF_ID"/>
        </index>        
    </table>

</database>
