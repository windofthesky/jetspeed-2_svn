<?xml version="1.0"?>
<!--
	Copyright 2004 The Apache Software Foundation
	
	Licensed under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License.
	You may obtain a copy of the License at
	
	http://www.apache.org/licenses/LICENSE-2.0
	
	Unless required by applicable law or agreed to in writing, software
	distributed under the License is distributed on an "AS IS" BASIS,
	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	See the License for the specific language governing permissions and
	limitations under the License.
-->
<document>
	<properties>
		<title>Jetspeed Simple Portlet Guide</title>
		<subtitle>Documentation for Creating a Simple Portlet</subtitle>
		<authors>
			<person name="David Le Strat" email="dlestrat@apache.org" />
		</authors>
	</properties>
	<body>
		<section name="Jetspeed Simple Portlet Guide">
			<p>
				This guide provides a tutorial for creating a very
				simple portlet. Portlets developers should follow the
				steps below.
			</p>
			<subsection name="1. The Portlet Class">
				<p>
				Create the file Simplest.java in a directory called
				simplest/WEB-INF/classes:
				<source>
public class Simplest extends javax.portlet.GenericPortlet
{
    public void doView(javax.portlet.RenderRequest request, javax.portlet.RenderResponse response)
                throws javax.portlet.PortletException, java.io.IOException
    {
            response.setContentType("text/html");
            response.getWriter().println("A very simple portlet.");
    }
}
				</source>
				</p>
				<p>
				Compile the class using the command,
				<source>
javac -cp ~/.maven/repository/org.apache.portals.jetspeed-2/jars/portlet-api-1.0.jar Simplest.java
				</source>
				</p>
			</subsection>
			<subsection name="2. The portlet.xml">
			<p>
			Create the file portlet.xml in the simplest/WEB-INF directory.
			<source><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<portlet-app id="simplest" version="1.0">
  <portlet id="Simplest">
    <portlet-name>Simplest</portlet-name>
    <display-name>Simple Display Name</display-name>
    <portlet-class>Simplest</portlet-class>
    <supports>
      <mime-type>text/html</mime-type>
      <portlet-mode>VIEW</portlet-mode>
    </supports>
    <supported-locale>en</supported-locale>
    <portlet-info>
      <title>Simple Title</title>
      <short-title>The world's simplest portlet</short-title>
    </portlet-info>
  </portlet>
</portlet-app>]]>
			</source>
			</p>
			</subsection>
			<subsection name="3. The web.xml">
			<p>
			Create the file web.xml in the simplest WEB-INF directory.
			<source><![CDATA[
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
                         "http://java.sun.com/dtd/web-app_2_3.dtd">
<web-app>
  <display-name>Simplest</display-name>
  <description>The world's simplest portlet</description>
</web-app>]]>
			</source>
			</p>
			</subsection>
			<subsection name="4. The PSML">
			<p>
			Create the file simplest.psml in the src/webapp/WEB-INF/pages directory of your Jetspeed Portal.
			The portlet-app id and the portlet-name are combined to identify the portlet fragment. Rebuild your portal.
			<source><![CDATA[
page>
  <defaults
     skin="orange"
     layout-decorator="tigris"
     portlet-decorator="tigris"
  />
  <title>The simplest portlet in the world</title>
  <metadata name="title" xml:lang="fr">La plus simple portlet du monde</metadata>

  <fragment id="simplest" type="layout" name="jetspeed-layouts::VelocityTwoColumns">
    <fragment id="simplest-1" type="portlet" name="simplest::Simplest">
      <property layout="TwoColumns" name="row" value="0" />
      <property layout="TwoColumns" name="column" value="0" />
    </fragment>
  </fragment>

  <security-constraints>
    <security-constraints-ref>public-view</security-constraints-ref>
  </security-constraints>
</page>]]>
			</source>
			</p>
			</subsection>
			<subsection name="5. The WAR file">
			<p>
			From the directory simplest combine the files above into a war file using the command,
			<source>
jar cvf ../simplest.war .
			</source>
			</p>
			</subsection>
			<subsection name="6. Deploy the WAR file">
			<p>
			Copy the war file to <code>$CATALINA_HOME/webapps/jetspeed/WEB-INF/deploy</code>. Jetspeed-2
			will deploy the webapp. Access the page in your navigator 
			<code>http://localhost:8080/jetspeed/portal/simplest.psml</code>.
			</p>
			</subsection>
		</section>
	</body>
</document>