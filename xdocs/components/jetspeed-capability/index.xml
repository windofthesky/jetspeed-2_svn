<?xml version="1.0" ?>
<!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at
    
    http://www.apache.org/licenses/LICENSE-2.0
    
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<document>
    <properties>
        <title>Jetspeed-2 Capabilities</title>
        <authors>
            <person name="David Le Strat" email="dlestrat@apache.org" />
        </authors>
    </properties>
    <body>
        <section name="Capabilities Overview">
            <p>
            Jetspeed-2 capabilities provides a mechanism for mapping the client used to access Jetspeed-2 to media types
            for page rendering.
            </p>
            <subsection name="Capabilities Definitions">
            <p>
            The Jetspeed-2 capability engine maps clients to media types to mime types.  Here are some more detailed
            definitions:
            <ul>
            <li>Clients: The application that initiates a request to the Jetspeed-2 portal engine.  Jetspeed-2 uses
            the <code>User-Agent</code> to determine the client that initiates a request.</li>
            <li>Media Type:  The type of media requesting the content (HTML, WML, etc.).  Content in Jetspeed-2
            can be requested by different type of devices through different media.</li>
            <li>Mime Type:  The type of content being requested.</li>
            </ul>
            </p>
            <p>
            Jetspeed-2 works with the following media types:
            <table>
            	<tr>
            		<th>Name</th>
            		<th>Character Set</th>
            		<th>Description</th>
            	</tr>
            	<tr>
            		<td>html</td>
            		<td>UTF-8</td>
            		<td>Rich HTML for HTML 4.0 compliants browsers</td>
            	</tr>
            	<tr>
            		<td>wml</td>
            		<td>UTF-8</td>
            		<td>Format for mobile phones and PDAs compatible with WML 1.1</td>
            	</tr>
            	<tr>
            		<td>vxml</td>
            		<td>UTF-8</td>
            		<td>Format suitable for use with an audio VoiceXML server</td>
            	</tr>
            	<tr>
            		<td>xml</td>
            		<td></td>
            		<td>XML 1.0</td>
            	</tr>
            	<tr>
            		<td>xhtml-basic</td>
            		<td>UTF-8</td>
            		<td>XHTML Basic used in WAP devices</td>
            	</tr>
           	</table>
            </p>
            <p>
            Jetspeed-2 is configured to recognize the following clients:
            <table>
            	<tr>
            		<th>Client</th>
            		<th>User Agent Pattern</th>
            		<th>Manufacturer</th>
            		<th>Preferred Mime Type</th>
            	</tr>
            	<tr>
            		<td>ie5</td>
            		<td>.*MSIE 5.*</td>
            		<td>Microsoft</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>ie6</td>
            		<td>.*MSIE 6.*</td>
            		<td>Microsoft</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>ns4</td>
            		<td>.*Mozilla/4.*</td>
            		<td>Netscape</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>mozilla</td>
            		<td>.*Mozilla/5.*</td>
            		<td>Mozilla</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>lynx</td>
            		<td>Lynx.*</td>
            		<td>GNU</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>opera7</td>
            		<td>.*Opera/7.*</td>
            		<td>Opera</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>ie5mac</td>
            		<td>.*MSIE 5.*Mac.*</td>
            		<td>Microsoft</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>safari</td>
            		<td>.*Mac.*Safari.*</td>
            		<td>Apple</td>
            		<td>html</td>
            	</tr>
            	<tr>
            		<td>xhtml-basic</td>
            		<td>DoCoMo/2.0.*|KDDI-.*UP\.Browser.*|J-PHONE/5.0.*|Vodafone/1.0/.*</td>
            		<td>N/A</td>
            		<td>xhtml</td>
            	</tr>
            	<tr>
            		<td>agentxml</td>
            		<td>agentxml/1.0.*</td>
            		<td>N/A</td>
            		<td>xml</td>
            	</tr>
            	<tr>
            		<td>nokia_generic</td>
            		<td>Nokia.*</td>
            		<td>Nokia</td>
            		<td>wml</td>
            	</tr>
            	<tr>
            		<td>up</td>
            		<td>UP.*|.*UP\.Browser.*</td>
            		<td>United Planet</td>
            		<td>wml</td>
            	</tr>
            	<tr>
            		<td>sonyericsson</td>
            		<td>Ercis.*|SonyE.*</td>
            		<td>SonyEricsson</td>
            		<td>wml</td>
            	</tr>
            	<tr>
            		<td>wapalizer</td>
            		<td>Wapalizer.*</td>
            		<td>Wapalizer</td>
            		<td>wml</td>
            	</tr>
            	<tr>
            		<td>klondike</td>
            		<td>Klondike.*</td>
            		<td>Klondike</td>
            		<td>wml</td>
            	</tr>
            	<tr>
            		<td>wml_generic</td>
            		<td>.*WML.*|.*WAP.*|.*Wap.*|.*wml.*</td>
            		<td>N/A</td>
            		<td>wml</td>
            	</tr>
            	<tr>
            		<td>vxml_generic</td>
            		<td>.*VoiceXML.*</td>
            		<td>N/A</td>
            		<td>vxml</td>
            	</tr>
            	<tr>
            		<td>nuance</td>
            		<td>Nuance.*</td>
            		<td>Nuance</td>
            		<td>vxml</td>
            	</tr>
            </table>
            </p>
            </subsection>
            <subsection name="Capabilities and Content Rendering">
            <p>
            The <code>media-type</code> is used to locate the appropriate decorations template for the given <code>media-type</code>.
			See the <a href="../../guides/guide-portal-design.html">portal design guide</a> for more information.
            </p>
            </subsection>
            <subsection name="Capabilities Implementation">
            <p>
            The <code>Capabilities</code> component derive a <code>CapabilityMap</code> from the information provided 
            by the <code>User-Agent</code> request header:
            <source>
cm = capabilities.getCapabilityMap(agent);
            </source>
            </p>
            <p>
            This operation occurs at the very beginning of Jetspeed-2 request pipeline processing.  Once the 
            <code>CapabilityMap</code> is retrieved, it is added to the Jetspeed-2 <code>org.apache.jetspeed.request.RequestContext</code>
            and made available to the portal engine for processing the request.
            </p>
            <p>
            The two pictures below describes the <code>Capabilities</code> interfaces and the relational database model
            backing the implementation.<br/><br/>
            <img src="images/capabilities-c.gif" border="0"/><br/><br/>
            <img src="images/capabilities-db.gif" border="0"/>
            </p>
            </subsection>
        </section>
    </body>
</document>