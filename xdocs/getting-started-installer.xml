<?xml version="1.0"?>
<!--
	Copyright 2004 The Apache Software Foundation
	
	Licensed under the Apache License, Version 2.0 (the "License");
	you may not use this file except in compliance with the License.
	You may obtain a copy of the License at
	
	http://www.apache.org/licenses/LICENSE-2.0
	
	Unless required by applicable law or agreed to in writing, software
	distributed under the License is distributed on an "AS IS" BASIS,
	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	See the License for the specific language governing permissions and
	limitations under the License.
-->
<document>
	<properties>
		<title>
			Getting Started with Jetspeed 2 using the installer
		</title>
		<subtitle>Installing Jetspeed-2 with the installer</subtitle>
		<authors>
			<person name="David Le Strat" email="dlestrat@apache.org" />
		</authors>
	</properties>
	<body>
		<section name="Jetspeed-2 Installer">
			<subsection name="Getting Started with the Installer">
			<p>
			Jetspeed 2.1 provides 2 installers:
			<ul>
			<li>The minimal installation, containing only the core portal and administrative portlets: 
			<a href="http://www.apache.org/dyn/closer.cgi/portals/jetspeed-2/binaries/jetspeed-2.1-installer.jar">Standard (Minimal) Installer</a></li>
			<li>An installer for installing Jetspeed-2 on a third party database: 
			<a href="http://www.apache.org/dyn/closer.cgi/portals/jetspeed-2/binaries/jetspeed-2.1-demo-install.jar">Jetspeed Demo Installer</a></li>
			</ul>
			</p>
			<p>
			To run the standard (minimal) installer:
			</p>
			<source>
java -jar jetspeed-2.1-installer.jar
            </source>
            <p>
To run the Jetspeed Demo installer:
            </p>
            <source>
java -jar jetspeed-2.1-demo-installer.jar
			</source>
			<p>	
			The installers are capable of running on headless (i.e. no gui) machines, and will detect so automatically.<br/>
			To force the installer in text mode manually, pass in the <b><i>text</i></b> parameter:
			</p>
			<source>
java -jar jetspeed-2.1-installer.jar text	
            </source>
		    </subsection>
		    <subsection name="Database Selection">
		    <p>
			The installer will ask you to choose a database for storing the Jetspeed database. We provide a default Derby database for demo systems.
			The Derby database runs in embedded mode inside the Jetspeed/Tomcat JVM. All other databases require additional configuration.
			If you selected Derby, you can go with the default parameters provided. For all other databases you must first create an area to hold the Jetspeed tables.
			For some databases this <i>area</i> is called a <i>catalog</i>, others call it a <i>schema</i>, while others call it a <i>database</i>. Consult your
			database documentation for details on how to create a catalog or schema to hold the Jetspeed tables. Additionally, you may need to create a database user
			to access the Jetspeed tables. Often it is required to grant access to the schemas (catalogs) for the given user.
			</p>
			<p>Jetspeed supported database list:
			<ul>
			<li>DB2</li>
			<li>Derby (default)</li>
			<li>MS SQL</li>
			<li>My SQL</li>
			<li>PostgreSQL</li>
			<li>Oracle (9i or higher)</li>
			<li>SapDB</li>
			<li>Manual database setup </li>
			</ul>
			</p>
			<p>If you choose the manual database setup, then the database scripts will not be run and you will need to configure the database manually after the installation.
			All database scripts are provided in the installation under the <i>database</i> directory. For your specific database, look for the corresponding directory name.
			During installation, you will be prompted for the following fields after chosing your database types (except for Derby):
			<ul>
			<li>A username</li>
			<li>A password</li>
			<li>A JDBC connection string</li>
			<li>A JDBC driver name</li>
			<li>The location of a valid JDBC driver.  The installer will copy this driver to the installed location in Tomcat.</li>
			</ul>
			The connections strings are only partially completed in the well-known format of the particular databaes.
			Please take care to complete the values in your connection string for your database. The driver name should be the right
			driver class for your database at the time of the making of this installation. Please ensure that a newer driver is not required for your database. 
			Note also that the location of the JDBC driver must be selected. We have not provided the file system path to the jar file but only the likely file name.
			You may want to check and see if newer versions of the driver are available.
			</p>
			<p>
			Once you have entered all of your parameters, the installer will test the database connection before proceeding.
			If the connection fails, please go back to the connection configuration setup and provide the correct parameters.
			If you choose to continue, the database scripts will not be run and you will need to configure the database manually after the installation.
			Once the installer verifies the database connection, you are ready to proceed with installation process.
			</p>
			<p>
			Please take note of the location where you are installing on your file system.<br/>
			Also, on a Windows platform make sure to use a location path without spaces, e.g. <i>NOT</i> under C:\Program Files.
			</p>
			</subsection>
			<subsection name="Starting Jetspeed-2">
			<p>
			Once you have completed a successful install, you are ready to start the Jetspeed Portal.
			On linux, here is an example where you have installed to the default location:
			</p>
			<source>
cd ~/jetspeed-2.1/bin
./startup.sh
			</source>
			<p>
			On windows, here is an example where you have installed to the default location:
			</p>
   			<source>
   cd C:\Apache\Jetspeed-2.1\bin
   startup.bat
   			</source>
   			<p>
 			The very first invocation of the portal requires anywhere from 10 seconds to 30 seconds for initial 
   			startup and final installation. After starting the server, start up a web browser 
   			and navigate to <a href='http://localhost:8080/jetspeed/portal'>http://localhost:8080/jetspeed/portal</a>	   			
			</p>
			</subsection>
			<subsection name="Login to Jetspeed-2">
			<p>
All preconfigured users have the same password as username (for example the <i>admin</i> user has the password <i>admin</i>)
If you installed with the Minimal installer, two test accounts are available:
			</p>
			<source>
admin 	  -- System administrator, super user
devmgr 	  -- Delegated security manager, can manage users with the "dev" (developer) role			
		   </source>
		   <p>
If you installed with the Demo installer, several additional test accounts are available:		   
 			</p>
 			<source>
admin 	  -- System administrator, super user
manager   -  Has system administration rights, but not super user
user 	  -- A sample user demonstrating with with a home page and advanced profiled menus 
tomcat 	  -- A sample user demonstrating a user without a home page
jetspeed  -- A sample user demonstrating discovery of pages by both group and role fallback profiling algorithms
subsite   -- Example of how to setup users with a primary subsite role fallback profiling rules
subsite2  -- Example of how to setup users with a secondary subsite role fallback profiling rules
devmgr 	  -- Delegated security manager, can manage users with the "dev" (developer) role 			
 			</source>
			</subsection>
			<subsection name="Jetspeed Desktop">
			<p>
The Jetspeed Desktop is a client-side JSR-168 aggregation engine.
To accesss the Desktop, navigate your browser to <a href='http://localhost:8080/jetspeed/desktop'>http://localhost:8080/jetspeed/desktop</a>
When switching between the /desktop and the /portal URLs, logout to start a new session.			
			</p>
			</subsection>
			<subsection name="Changing the Database">
			<p>
			After running the installation, you can manually reinitialize the database or even switch to another database.
			To do so, we provide an Ant script found under the <i>database</i> directory of your installed Jetspeed portal.
			The database configuration is defined in the <i>database.properties</i> file. To reinitialize or change the database,
			go to the database directory and edit the database.properties file, save it, and then run <b><i>ant</i></b>.
			</p>
			<p>Here is a sample database configuration file:
			</p>
			<source>
; Jetspeed Enterprise Portal 2.1 Database setup configuration
; db.type supported values: db2, derby, mssql, mysql, oracle, postgres, sapdb
db.type=mysql
: for db.type other than derby, the properties below need to be specified
db.username=j2
db.password=abracadabra
jdbc.url=jdbc:mysql://localhost:3306/prod-2
jdbc.driver.class=com.mysql.jdbc.Driver			
			</source>
			<p>If you are configuring a database for the first time after choosing Manual database setup in the installer, or want to try out
				a different type of database, make sure to copy the specific JDBC driver for the database to the Tomcat shared/lib folder <i>before</i> running ant.<br/>
			Note: for Derby, the needed driver is already placed there or available from the database/lib directory of your installed Jetspeed portal.</p>
			</subsection>
		</section>
	</body>
</document>
