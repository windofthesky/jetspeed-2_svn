<?xml version="1.0"?>
<!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the "License"); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at
  
  http://www.apache.org/licenses/LICENSE-2.0
  
  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<document>
  <properties>
    <title>Portal Site Administration Guide</title>
    <subtitle>Guide to Administering Portal Site</subtitle>
    <authors>
      <person name="David Sean Taylor" email="taylor@apache.org" />
      <person name="Jody McAlister" email="jmcalister@onehippo.com" />
      <person name="Niels van Kampenhout" email="n.vankampenhout@onehippo.com" />
    </authors>
  </properties>
  <body>
    <section name="Portal Site Administration Guide">
      <p>
        The Portal Site Manager can be looked at as a file-system-like tree of portal resources.
      </p>
      <p>
        The site is made up of three different kinds of resources:
      </p>
      <ul>
        <li><a href="#PSML_Pages">PSML Pages</a></li> 
        <li><a href="#Folders">Folders</a></li> 
        <li><a href="#Links">Links</a></li> 
      </ul> 
      <p>
        All portal resources can be customized in Jetspeed. Portal Site Manager is just one of the
        tools available for customizing.  Other tools are the Jetspeed Customizer (both Desktop and Portal), Edit Mode, 
        Configure Mode, Edit Defaults Mode of a portlet and the Portlet Selector.
      </p>
      <subsection name="PSML Pages">
        <p>
          The XML dialect for defining resources and elements that make up the site is also known as PSML (Portal Structure Markup Language).
          PSML is not a standard. 
        </p>
        <p>
          PSML pages define how and where portlets are placed on a page, as well as how the page is decorated and branded.
        </p>
        <p>
          A PSML page defines : 
          <ul>
            <li>metadata, such as titles and descriptions</li> 
            <li>decorations (both page and portlet)</li> 
            <li>layout fragments (number of columns on the page, and nesting of columns)</li> 
            <li>which portlets are displayed on the page, defined by portlet fragments</li> 
            <li>the position of the portlet on the page</li> 
            <li>properties of the portlets</li> 
            <li>preferences of a portlet</li> 
            <li>security constraints</li> 
          </ul> 
        </p>
        <p>
          To customize a PSML page through the Portal Site Manager, select it in the tree. On the right side of the tree
          four tabs will appear allowing you to customize various aspects of the page through a form.
        </p>
        <p>
          Each of the four tabs is described below.
        </p>
        <h4>Information Tab</h4>
        <p>
          The Information Tab allows you to customize the title and appearance of the page.
        </p>
        <img src="images/psm_psml_info.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Name</td>
            <td>Name of the .psml file.</td>
          </tr>
          <tr>
            <td>Title</td>
            <td>Name that appears in the xml title field for this object.</td>
          </tr>
          <tr>
            <td>Short Title</td>
            <td>Name that appears in the xml short title field for this object.</td>
          </tr>
          <tr>
            <td>Page Decorator</td>
            <td>Drop down menu of all available page decorators.</td>
          </tr>
          <tr>
            <td>Portlet Decorator</td>
            <td>Drop down menu of all available portlet decorators.</td>
          </tr>
          <tr>
            <td>Desktop Theme</td>
            <td>Drop down menu of all available desktop themes.</td>
          </tr>
          <tr>
            <td>Hidden</td>
            <td>Hidden folders do not show up on menus, but can still be navigated to. </td>
          </tr>
        </table>
        <h4>Security Tab</h4>
        <p>
          The Security Tab allows you to modify a page's security constraints. All security constraints
          defined for the selected page are shown in a list. To modify a constraint, select it from the list
          and choose a new value in the dropdown field.
        </p>
        <img src="images/psm_psml_security.png"/>
        <table>
            <tr>
              <th>Field</th>
              <th>Description</th>      
            </tr>
            <tr>
              <td>Constraints</td>
              <td>Any Security and Constraint types will be listed here for the selected item.</td>
            </tr>
          </table>
        <h4>Metadata Tab</h4>
        <p>
          The Metadata Tab shows a list of metadata properties that might be defined for the page, e.g. translations
          in different languages of the page title, such as shown in the screenshot below. Clicking on a property
          will load it in the form right below the list so that the values can be modified.
        </p>
        <img src="images/psm_psml_metadata.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Name</td>
            <td>Name of attribute in xml file for this object.</td>
          </tr>
          <tr>
            <td>Language</td>
            <td>Localization of the attribute.</td>
          </tr>
          <tr>
            <td>Value</td>
            <td>Text to be localized.</td>
          </tr>
        </table>
        <h4>Export Tab</h4>
        <p>
          The Export Tab provides an XML export of the page. The exported XML file can be used
          to store customizations made through the user interface in a custom portal project,
          so that when a new version of the portal is deployed, the customizations do not have
          to be made again.
        </p>
        <img src="images/psm_psml_export.png" />
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Export Object</td>
            <td>Export the selected item in XML format.</td>
          </tr>
        </table>
      </subsection>
      <subsection name="Links">
        <p>
          Links are URLs to external resources, usually outside of the site. 
          The element is persisted with the .link extension on the file system.
        </p>
        <p>
          To customize a link through the Portal Site Manager, select it in the tree. On the right side of the tree
          four tabs will appear allowing you to customize various aspects of the link through a form.
        </p>
        <p>
          Each of the four tabs is described below.
        </p>
        <h4>Information Tab</h4>
        <p>
          The Information Tab allows you to change the title and the URL of a link.
        </p>
        <img src="images/psm_link_info.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Name</td>
            <td>Name of .link file.</td>
          </tr>
          <tr>
            <td>Title</td>
            <td>Name that appears in the xml title field for this object.</td>
          </tr>
          <tr>
            <td>Short Title</td>
            <td>Name that appears in the xml short title field for this object.</td>
          </tr>
          <tr>
            <td>URL</td>
            <td>The resource to be displayed when clicked.</td>
          </tr>
          <tr>
            <td>Target Window</td>
            <td>The web browser action when the link is clicked on for displaying the Target. (New, Self, Parent, Top)</td>
          </tr>
          <tr>
            <td>Hidden</td>
            <td>Hidden folders do not show up on menus, but can still be navigated to. </td>
          </tr>
        </table>
        <h4>Security Tab</h4>
        <p>
          The Security Tab allows you to modify a link's security constraints. All security constraints
          defined for the selected link are shown in a list. To modify a constraint, select it from the list
          and choose a new value in the dropdown field.
        </p>
        <img src="images/psm_link_security.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Constraints</td>
            <td>Any Security and Constraint types will be listed here for the selected item.</td>
          </tr>
        </table>
        <h4>Metadata Tab</h4>
        <p>
          The Metadata Tab shows a list of metadata properties that might be defined for the link, e.g. translations
          in different languages of the link title, such as shown in the screenshot below. Clicking on a property
          will load it in the form right below the list so that the values can be modified.
        </p>
        <img src="images/psm_link_metadata.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Name</td>
            <td>Name of attribute in xml file for this object.</td>
          </tr>
          <tr>
            <td>Language</td>
            <td>Localization of the attribute.</td>
          </tr>
          <tr>
            <td>Value</td>
            <td>Text to be localized.</td>
          </tr>
        </table>
        <h4>Export Tab</h4>
        <p>
          The Export Tab allows you to export a link to an XML file.
        </p>
        <img src="images/psm_link_export.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Export Object</td>
            <td>Export the selected item in xml format.</td>
          </tr>
        </table>
      </subsection>
      <subsection name="Folders">
        <p>
          A folder is a container object that holds: 
        </p>
        <ul>
          <li>subfolders (which in turn can hold subfolders, pages, links...)</li> 
          <li>pages</li> 
          <li>links</li> 
        </ul>
        <p>
          Folders make up the physical layout of your site and have the following attributes :
        </p>
        <ul>
          <li>Localizable Metadata (name, title, short-title, description)</li> 
          <li>Optional Default-page </li> 
          <li>Optional Decorator</li> 
          <li>Hidden Flag (hidden folders do not show up on menus, but can still be navigated to)</li> 
          <li>Security Constraints </li> 
          <li>Menus</li> 
          <li>Document Ordering</li> 
        </ul>
        <p>
          To customize a folder through the Portal Site Manager, select it in the tree. On the right side of the tree
          seven tabs will appear allowing you to customize various aspects of the link through a form.
        </p>
        <p>
          Five of the seven tabs are described below (Information, Security, Metadata, Import, Export). The Menus and Order Tabs
          are placeholders for future functionalities and do not currently contain any information.
        </p>
        <h4>Information Tab</h4>
        <img src="images/psm_folder_info.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Name</td>
            <td>Name of the folder in the Portal Site Manager tree.</td>
          </tr>
          <tr>
            <td>Title</td>
            <td>Title of the Folder as it appears in the xml file.</td>
          </tr>
          <tr>
            <td>Short Title</td>
            <td>Short Tile of the folder as it appears in the xml file.</td>
          </tr>
          <tr>
            <td>Default Page</td>
            <td>Optional. Page to default to when browsing.</td>
          </tr>
          <tr>
            <td>Page Decorator</td>
            <td>Drop down menu of all available page decorators.</td>
          </tr>
          <tr>
            <td>Portlet Decorator</td>
            <td>Drop down menu of all available portlet decorators.</td>
          </tr>
          <tr>
            <td>Hidden</td>
            <td>Hidden folders do not show up on menus, but can still be navigated to. </td>
          </tr>
        </table>
        <h4>Security Tab</h4>
        <p>
          The Security Tab allows you to modify a folder's security constraints. All security constraints
          defined for the selected folder are shown in a list. To modify a constraint, select it from the list
          and choose a new value in the dropdown field.
        </p>
        <img src="images/psm_folder_security.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Constraints</td>
            <td>Any Security and Constraint types will be listed here for the selected item.</td>
          </tr>
        </table>
        <h4>Metadata Tab</h4>
        <p>
          The Metadata Tab shows a list of metadata properties that might be defined for the folder, e.g. translations
          in different languages of the folder title, such as shown in the screenshot below. Clicking on a property
          will load it in the form right below the list so that the values can be modified.
        </p>
        <img src="images/psm_folder_metadata.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Name</td>
            <td>Name of attribute in xml file for this object.</td>
          </tr>
          <tr>
            <td>Language</td>
            <td>Localization of the attribute.</td>
          </tr>
          <tr>
            <td>Value</td>
            <td>Text to be localized.</td>
          </tr>
        </table>
        <h4>Import Tab</h4>
        <p>
          The Import Tab allows you to import a folder that you previously exported as XML file.
        </p>
        <img src="images/psm_folder_import.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>File to Import</td>
            <td>Use the browse button to search local files for the xml file to be imported.</td>
          </tr>
          <tr>
            <td>File Destination</td>
            <td>The path to place the xml file being imported.</td>
          </tr>
        </table>
        <h4>Export Tab</h4>
        <p>
          The Export Tab allows you to export a folder to an XML file. Optionally you can resursively
          export all sub items inside the folder as well by checking the "Export recursively" checkbox.
        </p>
        <img src="images/psm_folder_export.png"/>
        <table>
          <tr>
            <th>Field</th>
            <th>Description</th>      
          </tr>
          <tr>
            <td>Export Object</td>
            <td>Export folder.metadata in xml format.</td>
          </tr>
          <tr>
            <td>Export Recursively</td>
            <td>Export all sub-items in the xml format as well as the folder.metadata.</td>
          </tr>
        </table>
      </subsection>
      <subsection name="Portal Tree vs. User Tree">
        <p>
          There are system wide portal resources and personalized or user specific portal resources. These are
          represented by separate trees. The Portal Site Manager allows you to switch between these two
          trees.
        </p>
        <h4>Portal Tree</h4>
        <img src="images/psmportal.png" />
        <h4>User Tree</h4>
        <img src="images/psmusertree.png" />
      </subsection>
      <subsection name="Control Folders">
        <p>
          Control folders always start with the underscore _.
        </p>
        <p>
          Control folders are used to separate pages based on runtime parameters.  For example, you may have a different set of pages for a phone vs. a full web-browser.  
          In that case, you place your pages for the phone under a WML directory, where you may have less portlets per page than the HTML directory.
        </p>
        <p>
          There is a special folder named (_subsite_root) : 
        </p>
        <ul>
          <li>Subsites sub-divide your portal site into independent "portal site" trees.  This enables use-case scenarios such as hosting two or more 
          portals on the same portal instance (app server)</li> 
          <li>Users can be configured to point to a particular subsite which will become their view of the portal</li> 
        </ul>
        <p>
          The User folder (_user) : 
        </p>
        <ul>
          <li>The _user folder holds the home pages of all users.  Each user can have a folder with multiple subfolders, pages and links</li> 
          <li>A user is not required to have a home folder.  Depending on the user profile, the user home page may or may not be used </li> 
          <li>Usually, a user's home page is made customizable (editable) to the user, but not to others</li> 
          <li>Jetspeed uses "templates" to create default pages for users when the user first registers or is created by an Administrator</li> 
        </ul>
        <p>
          Roles and Group Folders (_role and _group) : 
        </p>
        <ul>
          <li>Role and group folders are useful for sharing pages based on the roles or groups that a user belongs in.  Typical use cases are for granting (or denying) 
            access to pages</li> 
          <li>Role folder names should be the same as the roles defined in the system, likewise for groups</li> 
          <li>A user's profile defines where pages are to be searched</li> 
          <li>A user profile called "role-fallback" looks for pages in the _role directory, based on the users's security profile.  It will search 
            through all folders based on the roles that a user holds</li> 
          <li>A common profile rule is to first search the user's home directory, then each of the role directories for the given user, and the the 
            default root tree to find the page</li> 
        </ul>
      </subsection>
    </section>
  </body>
</document>