<?xml version="1.0"?>
<!--
	Licensed to the Apache Software Foundation (ASF) under one or more
	contributor license agreements.  See the NOTICE file distributed with
	this work for additional information regarding copyright ownership.
	The ASF licenses this file to You under the Apache License, Version 2.0
	(the "License"); you may not use this file except in compliance with
	the License.  You may obtain a copy of the License at
	
	http://www.apache.org/licenses/LICENSE-2.0
	
	Unless required by applicable law or agreed to in writing, software
	distributed under the License is distributed on an "AS IS" BASIS,
	WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	See the License for the specific language governing permissions and
	limitations under the License.
-->
<document>
    <properties>
        <title>Permissions Administration Guide</title>
        <subtitle>Guide to Administering Security Permissions</subtitle>
        <authors>
            <person name="David Sean Taylor" email="taylor@apache.org"/>
            <person name="Jody McAlister" email="jmcalister@onehippo.com"/>
            <person name="Niels van Kampenhout" email="n.vankampenhout@onehippo.com"/>
        </authors>
    </properties>
    <body>
        <section name="Security Permissions Administration Guide">
            <p> 
                Security permissions restrict access to resources in the portal. Portal resources (folders, links,
                pages, portlets) can be secured with either: 
                <ul>
                    <li>Security Constraints (based on Jetspeed-specific security constraints)</li>
                    <li>Security Permissions (based on a Java Security Policy)</li>
                </ul> 
                The default security is Constraints as they are easier to configure by a portal administrator. The
                advantage of Permissions is that they are stored in a central repository in the Jetspeed database, and
                they adhere to the Java Security Standard. Both constraints and permissions inherit. Meaning that if you
                set a permission or constraint on a folder, it is inherited by all subfolders and pages. Permissions are
                an implementation of a Java Security Policy stored in a database. 
            </p>
            <p> A permission grants a permission to a security principal, either: 
                <ul>
                    <li>a role</li>
                    <li>a group</li>
                    <li>a user</li>
                    <li>or * for all users</li>
                </ul> 
                A permission defines the action, which can be standard portlet modes: 
                <ul>
                    <li>view</li>
                    <li>edit</li>
                    <li>help</li>
                </ul> 
                Or Jetspeed extended portlet modes: <ul>
                    <li>edit_defaults</li>
                    <li>about </li>
                    <li>config </li>
                    <li>print</li>
                </ul>
            </p>
            <subsection name="Permission Management">
                <p>
                    Permission Management is located on the fourth tab from the left on the Jetspeed Administrative Portlets page.
                    It contains one portlet, Security Permissions, which allows you to set permissions for a role on three
                    different resource types: portlets, folders, and pages.
                </p>
                <p><img src="images/perms-portlets.png" /></p>
                <h4>The Permissions User Interface</h4>
                <p>
                    The UI of the Permissions portlet is devided into the following sections:
                </p>
                <table>
                    <tr>
                        <th>UI section</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td>Resource type tabs</td>
                        <td>
                            <p>
                                Select the resource type you want to define permissions for by
                                clicking on the corresponding tab.
                            </p>
                            <p>
                                The resource types are:
                            </p>
                            <ul>
                                <li>Portlets</li>
                                <li>Folders</li>
                                <li>Pages</li>
                            </ul>
                            <p><img src="images/perm-tabs.png" /></p>
                        </td>
                    </tr>
                    <tr>
                        <td>Permissions listing</td>
                        <td>
                            <p>
                                The list of permissions defined for the selected resource type. Each permission displays
                                the resource name, the permitted actions, and the roles to which this permission applies.
                            </p>
                            <p><img src="images/perm-resources.png" /></p>
                        </td>
                    </tr>
                    <tr>
                        <td>Permission form</td>
                        <td>
                            <p>
                               This form allows you to edit the permission selected in the list, or create a new permission.
                            </p>
                            <p>
                                "Roles" display a list of roles in which you can select the roles to which this permission applies,
                                by checking the corresponding checkboxes. 
                            </p>
                            <p>
                                "Actions" displays a list of actions in which you can select the actions that are permitted 
                                to the selected roles, on the selected resource, by checking the corresponding checkboxes.
                                Available actions are:
                            </p>
                            <ul>
                                <li>View</li>
                                <li>Edit</li>
                                <li>Help</li>
                                <li>About</li>
                                <li>Config</li>
                                <li>Edit Defaults</li>
                                <li>Print</li>
                            </ul>
                            <p>
                                Finally, in the top right corner of the form are four buttons to create a new permission, or
                                to save, revert or delete the selected permission.
                            </p>
                            <p><img src="images/perms-buttons.png" /></p>
                        </td>
                    </tr>
                </table>
                <h4>Editing a Permission</h4>
                <p>
                    To edit a permission, select one in the permission listing. The permission settings will be loaded in the
                    form. Select the roles this permission should apply to by checking the appropriate checkboxes. Check the actions
                    that you want to permit by checking the appropriate checkboxes. Save the permission by clicking on the
                    "Save" button. As long as you have not saved, you can revert your changes by clicking on the "Revert" button.
                </p>
                <h4>Deleting a permission</h4>
                <p>
                    To delete a permission, select on in the permission listing, and then click on the "Delete" button.
                </p>
                <h4>Creating a New Permission</h4>
                <p>
                    To create a new permission, click on the "New" button. The "Resource" text field will be enabled for editing, enter
                    the resource name here. The new permission will show up immediately in the listing. Select the roles and actions as 
                    described above for editing an existing permission. Click on "Save" to store the permission. If you decide you
                    do not want to create the new permission after all, click on "Delete" to remove it.
                </p>
            </subsection>
            <subsection name="Permission Usage">
                <p> 
                    A security definition is referenced by portal resources to secure that particular resource. The
                    following resources can be secured: 
                    <ul>
                        <li>Folder: in the folder metadata</li>
                        <li>Page: in a PSML file </li>
                        <li>Link: in a .link file </li>
                        <li>Portlet Window: one instance of a portlet on a page</li>
                        <li>Portlet Definition: all instances of a portlet on all pages</li>
                        <li>Portlet Application: all portlets in a portlet application</li>
                    </ul> 
                    Securing a resource is as simple as defining a permission definition using the administrative
                    portlet defined above. You can do this from several areas of the portal: 
                    <ul>
                        <li>1. The Site Manager to secure a folder, page or link</li>
                        <li>2. Portlet Application Manager, to secure a Portlet Application or Portlet Definition</li>
                        <li>3. Config Mode, if available for a portlet, you can secure a portlet instance</li>
                    </ul> 
                    Additionally, portlets can be secured in the deployment descriptors. See the 
                    <a href="../deployguide/index.html">deployment</a> guide for more details. 
                </p>
            </subsection>
        </section>
    </body>
</document>
